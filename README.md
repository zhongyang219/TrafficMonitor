# TrafficMonotor 简介
Traffic Monitor是一款用于Windows平台的网速监控悬浮窗软件，可以显示当前网速、CPU及内存利用率，支持嵌入到任务栏显示，支持更换皮肤、历史流量统计等功能。<br>
# 主要特性
* 显示当前实现网络传输速率、CPU和内存占用率<br>
* 如果电脑有多个网卡，支持自动和手动选择网络连接<br>
* 查看网络详细信息<br>
* 支持嵌入到任务栏显示<br>
* 支持更换皮肤<br>
* 历史流量统计<br>
# 截图
主悬浮窗：<br>
![](https://github.com/zhongyang219/TrafficMonitor/raw/master/Screenshots/main1.png)<br>
右键菜单：<br>
![](https://github.com/zhongyang219/TrafficMonitor/raw/master/Screenshots/main.png)<br>
任务栏窗口：<br>
![](https://github.com/zhongyang219/TrafficMonitor/raw/master/Screenshots/taskbar.PNG)<br>
多彩皮肤：<br>
![](https://github.com/zhongyang219/TrafficMonitor/raw/master/Screenshots/skins.PNG)<br>
# 使用方法
程序启动后在窗口点击鼠标右键可以弹出右键菜单，主要功能都集中在这个菜单中。如果需要让它嵌入到任务栏显示，请勾选“显示任务栏窗口”。
# 自定义皮肤
![](https://github.com/zhongyang219/TrafficMonitor/raw/master/Screenshots/selecte_skin.png)<br>
软件支持更换皮肤。用户还可以根据自己的需要编辑自己的皮肤。<br>
皮肤文件放在程序所在目录的`skins`目录下，每个皮肤被放到单独的文件夹下，文件夹的名字就是皮肤的名称。<br>
在`skins`目录下新建一个文件夹，制作好`background.bmp`和`background_l.bmp`两个背景图片放在里面，然后编辑skin.ini文件，`text_color`是该皮肤对应的文字颜色，它是一个WIN32的COLORREF的值，`skin_author`是用于显示到更换皮肤界面中的皮肤作者。<br>
在V1.70及以后的版本中，还可以通过skin.ini来指定悬浮窗的大小，以及4个项目的大小和位置。<br>
skin.ini文件中各项键值的含义如下所示：<br><br>
>其中的“默认值”是当skin.ini文件中没有某个键时，程序获得的默认的值。<br>

**[skin]节：**<br>

| 键   | 含义              | 默认值 |
| ---- | --------------- | ------ |
| text_color | 文本颜色 | 0 |
| skin_author | 皮肤作者 | unknow |
| up_string | “上传”项目的显示文本 | 上传:  |
| down_string | “下载”项目的显示文本 | 下载:  |
| cpu_string | “CPU”项目的显示文本 | CPU:  |
| memory_string | “内存”项目的显示文本 | 内存:  |

**[layout]节:**<br>
* 注意：V1.69及以前版本不支持[layout]节。

| 键   | 含义              | 默认值 |
| ---- | --------------- | ------ |
| text_height | 每个项目的高度 | 20 |

勾选“显示CPU和内存利用率”时的布局：

| 键   | 含义              | 默认值 |
| ---- | --------------- | ------ |
| width_l | 窗口的宽度 | 220 |
| height_l | 窗口的高度 | 43 |
| up_x_l | “上传”的x坐标 | 5 |
| up_y_l | “上传”的y坐标 | 2 |
| up_width_l | “上传”的的宽度 | 108 |
| down_x_l | “下载”的x坐标 | 114 |
| down_y_l | “下载”的y坐标 | 2 |
| down_width_l | “下载”的的宽度 | 110 |
| cpu_x_l | “CPU”的x坐标 | 5 |
| cpu_y_l | “CPU”的y坐标 | 22 |
| cpu_width_l | “CPU”的的宽度 | 108 |
| memory_x_l | “内存”的x坐标 | 114 |
| memory_y_l | “内存”的y坐标 | 22 |
| memory_width_l | “内存”的的宽度 | 110 |

不勾选“显示CPU和内存利用率”时的布局：

| 键   | 含义              | 默认值 |
| ---- | --------------- | ------ |
| width_s | 窗口的宽度 | 220 |
| height_s | 窗口的高度 | 28 |
| up_x_s | “上传”的x坐标 | 5 |
| up_y_s | “上传”的y坐标 | 4 |
| up_width_s | “上传”的的宽度 | 108 |
| down_x_s | “下载”的x坐标 | 114 |
| down_y_s | “下载”的y坐标 | 4 |
| down_width_s | “下载”的的宽度 | 110 |

制作好后重启一下软件就可以在列表中看到新增加的皮肤了。<br>
# 选项设置
![](https://github.com/zhongyang219/TrafficMonitor/raw/master/Screenshots/option.png)<br>
在右键菜单选择“选项...”可以进入选项设置。在选项设置对话框中，可以单独设置主窗口和任务栏窗口的文本颜色、字体、背景颜色，同时可以自定义显示的文本。还可以选择交换上传和下载的位置。<br>
在“常规设置”选项卡中，可以设置是否在程序时自动检查更新，以及是否需要在开机是自动进行。
# 更新日志
V1.67以后版本的更新日志请参见releases页面：https://github.com/zhongyang219/TrafficMonitor/releases
## V1.67 (2018/01/21)
* 修正当主窗口和任务栏窗口都不显示CPU和内存利用率时，鼠标提示中的CPU和内存利用率不刷新的问题
* 修正了当任务栏左侧有自定义工具栏或快速启动栏时，任务栏窗口位置不正确的问题
* 新增自动检查更新功能
* 开机自启动功能改为写入注册表实现，去掉右键菜单中的“开机自动运行”项，移至选项设置——常规设置
* 增加任务栏窗口可以放在任务栏的左侧
* 其他细节方面的改进
## V1.66 (2017/12/31)
* 新增鼠标悬浮提示会实时更新
* 优化关于启动时弹出“已经有一个程序正在运行”对话框的处理
* 增加无法嵌入任务栏时自动重试的处理
* 增加任务栏窗口的刷新频率，在一定程度上解决通知区域图标变化时任务栏窗口闪烁的问题
* 历史流量统计对话框中增加图形指示
## V1.65 (2017/11.16)
* 修正了更新Win10秋季创意者更新后，设置了开机启动时会弹出“已经有一个程序正在运行”的对话框的问题
* 增加了选项设置对话框，将字体和字体颜色设置放到了选项设置对话框中，增加了显示文本的设置
* 修正了有时开机启动时会弹出“窗口无法嵌入任务栏”的提示的问题
* 增加程序全屏时隐藏悬浮窗的选项，并修正了全屏视频或游戏时悬浮窗会自己跳出来的问题
* 任务栏窗口的宽度不再固定，而是会根据文本宽度自动调整
* 连接详情对话框中增加右键菜单复制功能
## V1.64 (2017/07/28)
* 任务栏窗口信息显示改成了双缓冲绘图，彻底修正了任务栏窗口显示出现难看的色块的问题
* 当任务栏从桌面底部移动到两旁时，任务栏窗口会实时切换横排和竖排显示
## V1.63 (2017/07/05)
* 增加当无法保存设置时的警告信息
* 优化通知区图标行为，当设置了隐藏主窗口时，双击通知区图标才显示主窗口
* 调整了任务栏窗口显示网速部分的宽度，以修正网速过大时显示不全的问题
* 任务栏窗口右键菜单中增加显示通知区图标选项
* 修正有时设置了去掉通知区图标后再次启动时图标还在的问题
* 如果设置了主窗口总是置顶，每隔5分钟自动执行一次置顶操作，以解决有时窗口没有置顶的问题
## V1.62 (2017/05/29)
* 启动时如果检测到历史流量统计中有重复的日期就将它们合并
* 去掉一些菜单项中不必要的省略号
* 其他细节方面的改进
## V1.61 (2017/05/19)
* 连接详情中增加物理地址、IP地址、子网掩码和默认网关几个项目显示
* 鼠标提示信息合并为一个提示，如果设置为不显示CPU和内存利用率时在提示信息里显示
* 修正了连接详情窗口中的鼠标提示显示在窗口后面的问题
* 修正了主窗口没有置顶时任务栏窗口的鼠标提示在窗口后面的问题
* 修正了切换网络连接后的1秒网速显示为一个很大的值的问题
* 修正了当切换网络连接时统计的流量不正确的问题
## V1.60 (2017/05/11)
* 连接详情界面改为列表显示，增加程序已运行时间项目
* 新增历史流量统计功能，可以记录每一天总共使用的流量
* 关于对话框中增加捐赠功能
* 关于对话框中增加检查更新链接，点击可跳转到百度网盘链接
* 优化了自动选择的处理，在较大程度上解决了有时无法显示网速的问题
* 较大程度上解决了少数情况下设置总是置顶、鼠标穿透时无效的问题
* 新增当鼠标指向主窗口或任务栏窗口对应的项目时，提示今日已使用流量和内存使用详情
* 更换了程序图标和通知区域图标，风格更加简洁
## V1.54 (2017/04/29)
* 修正当设置了隐藏主窗口和显示任务栏窗口时，在任务视图中有一个看不见的窗口的问题
* 修正某些情况下会导致变成灰色的菜单项变回可用状态的问题
* 修正在“自动选择”模式时，当断开WIFI再重新连接后可能会出现无法自动选择有网络的连接的问题
 优化：当显示任务栏窗口时，允许隐藏通知区图标。
## V1.53 (2017/03/07)
* 修正选择皮肤时可能会出现顺序错乱的问题
* 优化：ini文件保存选择的皮肤的名称而不是序号，以解决添加或删除皮肤后选择的皮肤不正确的问题
* 修正将焦点设置到任务栏窗口后按回车或ESC键任务栏窗口关闭的问题
* 新增设置字体功能
## V1.52 (2017/03/04)
* 修正当显示任务栏窗口时，打开或关闭通知区图标会导致资源管理器卡住的问题
* 优化：打开任务栏窗口时，窗口中的信息可以立即显示出来
* 新增：允许取消开机自启动，“开机自动运行”菜单项增加复选标志
## V1.51 (2017/03/02)
* 修正重启资源管理器之后任务栏窗口无法正常显示的问题
* 修正重启资源管理器之后通知区图标消失的问题
* 修正任务栏窗口上网速显示字符串过长时字符显示不全的问题
* 修正在特定情况下可能会导致程序停止工作的问题
* 优化：当任务栏在屏幕左侧或右侧时，任务栏窗口的4个项目以竖排显示（必须关闭任务栏窗口再打开才能生效）
* “关于”对话框中增加“联系作者”超链接
## V1.50 (2017/02/25)
* 新增更换皮肤功能（点击右键菜单——其他功能——更换皮肤，新增了7套皮肤）
* 新增当网络变化时，自动更新“选择网络连接”中的子菜单项
* 新增允许交换上传和下载的位置
## V1.43 (2017/02/22)
* 优化自动选择连接的处理，不选择已断开的连接
* 修正任务栏窗口切换“显示CPU和内容利用率”后，“隐藏主窗口”的复选框消失的问题
* 优化：当任务栏窗口无法嵌入任务栏时（如被安全软件阻止），如果任务栏把窗口覆盖，则窗口自动置顶。
## V1.42 (2017/02/19)
* 优化：任务栏窗口的位置不再总是固定，当任务栏最小化区域宽度变化时自动调整任务栏窗口的位置
* 修正了当把任务放在桌面的左边或右边时任务栏窗口位置不正确的问题
## V1.41 (2017/02/18)
* 新增隐藏主界面功能
* 更改设置时实时保存，解决关机时无法保存设置的问题
* 新增开机自动运行功能，程序会创建快捷方式到开始菜单的启动目录
* 新增在无法嵌入任务栏时强行将窗口移动到正确的位置，并弹出提示信息
## V1.40 (2017/02/16)
* 增加任务栏窗口，作为工具栏样式嵌入任务栏，不再占用屏幕区域
* 增加主悬浮窗文字颜色设置
* 任务栏窗口支持背景颜色和文字颜色设置
## V1.30 (2017/02/13)
* 增加CPU和内存利用率显示。
* 增加鼠标穿透功能，悬浮窗不再影响鼠标操作
## V1.20 (2017/02/11)
* 去掉任务栏图标，增加通知区图标，右击通知区图标可弹出右键菜单
* 右键菜单增加“锁定窗口位置”、“显示通知区域图标”项目
* 增加移动时不允许超过屏幕边界的处理
* 增加程序只允许一个实例运行的处理
* 连接详情中增加自程序启动以来已发送和接收字节数显示，并增加数据以KB、MB或GB为单位的显示
* 修正了当上传速度的字符串太长时可能会导致下载速度显示不全的BUG
## V1.00 (2017/02/10)
* 初版发行
